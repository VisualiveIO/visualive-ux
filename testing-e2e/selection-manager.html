<!DOCTYPE html>
<html>
  <head>
    <title>Zea UX</title>
    <style>
      html,
      body,
      #canvas {
        padding: 0;
        margin: 0;
        width: 100%;
        height: 100%;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas"></canvas>

    <script src="../node_modules/@zeainc/zea-engine/dist/index.umd.js"></script>
    <script src="../dist/index.umd.js"></script>

    <script>
      const { GLRenderer, Scene, GeomItem, Material, Vec3, Xfo, Color, Cuboid } = window.zeaEngine
      const { SelectionManager, SelectionTool } = window.zeaUx

      const domElement = document.getElementById('canvas')

      const scene = new Scene()
      scene.setupGrid(10, 10)

      const renderer = new GLRenderer(domElement, { hideSplash: true })
      renderer.setScene(scene)

      {
        const material1 = new Material('material1', 'SimpleSurfaceShader')
        material1.getParameter('BaseColor').setValue(new Color('#94C47D'))

        const geomItem1 = new GeomItem('CuboidGeometryItem', new Cuboid(0.7, 0.7, 0.7), material1)

        const geomItem1Xfo = new Xfo()
        geomItem1Xfo.tr = new Vec3(0, 0, 0.35)
        geomItem1.getParameter('GlobalXfo').setValue(geomItem1Xfo)

        scene.getRoot().addChild(geomItem1)
      }

      /** */
      {
        const appData = {
          scene,
          renderer,
        }

        const selectionManager = new SelectionManager(appData, { enableXfoHandles: true })

        const cameraManipulator = renderer.getViewport().getManipulator()
        const selectionTool = new SelectionTool({ selectionManager, ...appData })
        selectionTool.activateTool()

        const setToolToSelectionTool = () => {
          renderer.getViewport().setManipulator(selectionTool)
        }

        const setToolToCameraManipulator = () => {
          renderer.getViewport().setManipulator(cameraManipulator)
        }

        document.addEventListener('keydown', (e) => {
          switch (e.key) {
            case 's':
              console.log('S')
              setToolToSelectionTool()
              break
            case 'c':
              console.log('C')
              setToolToCameraManipulator()
              break
          }
        })
      }

      renderer.getViewport().getCamera().setPositionAndTarget(new Vec3(0, 4, 2), new Vec3(0, 0, 0))
    </script>
  </body>
</html>
